---
TODO
---

changed:
line 644  add 5
add    </div> at 616
remove variables at 1159
	
	
// TODO:  Find a way to show the weight at the end, without having to start packing another box

Fix weights calculating wrong. Probably multiplying or not resetting or something
	

2 insul pouches have an empty accessory box first.
Add weights (reference jesse's list?).






Keep revision number on bottom of results page, so i can see it in screenshots of issues (may not be useful since issues are being sent through saving the printout as pdf).

Add instructions to bottom of results page (select Zebra ZP500 printer. Each box will print on it's own page. You can also save as /print to pdf if you want)

Put accessory inputs on shared line to take up less vertical room.

"Solid State Relays included with box carrying most POLDs"
Need to make a loop for assigning POLDs one at a time to a box, storing the value of which box has the most, (loop/function variables defined at top)
then at the end, assign SSRs to that box as well (with value of 0 I guess).

Add LDS power wire?
include (value 0) in shipper. number entry (5ft increments, default 10ft)

Add more separation to buttons on top row.

Add section titles, and collapsible "Uncommon Accessories" sections?

Maybe format as important/common things on left, uncommon/default things on right column.

Make scrollTo work again to scroll to top from Reset button.

// TODO:  "Solid State Relays included with box carrying most POLDs"  (although putting it in the last box a pold or leak rope went into is a lot easier)






---
MAYBE DO
---
Have a separate button to Save results (as pdf? csv?) for uploading to zoho? Remove the page breaks from that version, so it prints on like 1 page.

Blank out the form entries for inputs that were hidden when switching system types (like insulated pouches when switching to POLD-Only)


// TODO:  Don't show the accessory box for POLD-Only if it's empty and your first box is something else (like medium shipper for 1 Insulated Pouch or something).
// Results are showing an empty accessory box if all you have is insulated pouches.
// Make sure the "if (lastboxnumberofitems > 0) {}" condition is there.

Packing Results:
-- POLD System --
Accessory (13x10x5)  [Box 1 of 62]:
Medium Shipper (20x12x8)  [Box 2 of 62]:
• 1 Insulated Pouch


Add date to printed pages? (maybe not, otherwise they'll know if we held it or something)

Maybe default the page size to 4x6? 
But might make it hard to tell if it's going to the right printer (i'm assuming i can't choose a default printer).

Selecting specific printer with javascript
If you have a closed environment (like an intranet) you could print on the server side to a printer connected to a server. The exact details would depend on your server setup and you'd best discuss that with your local system administrator.
https://stackoverflow.com/a/17349503

Maybe add level 1 and level 2 debugging levels, for basic info like these 2 lines, versus a line after each and every item is packed

Align checkboxes that are near the top

Number the boxes like Box 1, Box 2.

Align the edges of all input elements (maybe use/don't use row elements?).

Add Mailer "if case" for replacement or shipping of single accessory:
Mailer(11x9x1) = 2.5 (Use for shipments of accesory only)

Checkboxes aren't working with chrome dark mode extension. (might be an issue with the bootstrap dark version fork i'm using?)

Might wanna change bullets to blank spaces for checkmarks.

Change page title on sumbit/print to a good filename (maybe even a client name entry box?) like 2021-04-17 ClientName (maybe with a random string of numbers at the end or timestamp, so there aren't duplicate filenames) or 2021-04-17 0223p ClientName  or  2021-04-17 1422 ClientName

Icons or images beside each accessory box.

Add logo of shelled peanut halfway out of an open box (flaps 45 degrees up/out, corner facing us). Use as favicon too.

Wizard design? Where things show up after clicking the previous thing (to filter options by LDS/POLD only/accessories only/replacement/custom/all/etc).

Bigger up/down number buttons?

Show up/down number buttons by default, before entering anything?

// Currently just hard defining this group of items as always going in the first box (not checking if they fit) (according to Bryce rules)
// Maybe change this if there are enough cases to break it, like multiple control panels or something.
"Panel, SCV, Hidden Wire and Pam1 always in Box 1"

























---------------------------------
DONE
---------------------------------


3.0.11  2021-04-12 ---
Added special cases within packing function, after it finishes packing a box, to check if it just packed an LDS box, then tries to pack a 14x14 first (to avoid cases where a 14x14 is called because a junction box is present but only a few accessories get packed in it first then it picks another 14x14 for junction box, resulting in bigger boxes than needed). 
(I think it's also running after packing an accessory box since it has the same value as the standard lds box (12), but I think it's working better that way in the few cases I've tested so I'm leaving it lol...)

Reordered some form items (API before POLD, to reflect packing order and improve layout. SO# at end since it's not required unless printing labels for multiple boxes, which is probably rare).

Fixed some form spacing, added "Extra Info" section title, added some code comments.





3.0.10  2021-04-08 ---
Changed box names to a standardized format to sync up terms with upstairs/fedex and downstairs/warehouse, to:

Standard Shipper (19x12x7) = 12 (For .75-1.5" systems only)
Medium Shipper (20x12x8) = 6 (Used for 2" systems or Insulated Pouch only)
Large Shipper (18x18x14) = 18 (Used only for 2.5" and 3" systems)
Bubble Mailer (11x9x1) = 2.5 (Use for shipments of accesory only)
Panel Box (10x7x3) = 6
Recirc/4 hr Box (9x4x3) = 6 (Only to be used for single Recirc Pump Switch or 4hr Timer)
Accessory Box (13x10x5) = 12
Large Accessory Box (14x14x14) = 48 (Use only if EJB is included or if Point total is greater than or equal to 49)




3.0.9  2021-04-07 ---
Added favicon from fontawesome and converted by realfavicongenerator.net

Minor wording update to pold error alert.




3.0.8  2021-04-07 ---
Disable print button if there's only one box.

Change "Shipping Order Number" to "Sales Order Number".

Validate if SO# exists when printing multiple boxes.

Hide Known Issues link by default unless debugging is enabled (also open in new tab).




3.0.7  2021-03-31 ---
SO# align right (text-end) on print output.

Hide SO# on additional pages from user display, until you print it.

Remove a line break from print headers like SO#, Replacement, POLD System, Accessories Only.

Reduced width of resultsBoxContainer so SO# isn't so far right.

Changed width of back/start over/print button containers from for better responsive layout.

Changed print button from float-right to float-end.




3.0.6  2021-03-31 ---
Added SO# entry box on top (to keep track of multiple pages together, and matching printed labels to packing lists etc).

Added SO# to each page of print output (not required and not showing if blank).

Defaulting everything to hidden on page load, until system type is selected. (so people won't ignore those buttons, which are used for logic).
(Added 2 new divs to wrap the whole form--besides header buttons--and footer to be hidden by default)

System: LDS  no longer auto-selected by default on page load.

Added short instruction text visible on page load.

Changed which form entries are visible with different system selections, from Bryce’s feedback.
(Hide more acessories if POLD-Only is selected? (Junction Box, Insulated Pouch and 4hr timer should be hidden, I’m thinking Recirc Pump Switch too. -Bryce))

Minor other tweaks like margins and comments.




3.0.5  2021-03-30---
Fixed/Improved print output (color/margin/padding).

Changed negative margin to 0 margin, because it works in every browser. 
(TEST PRINTING IN IE/EDGE. That might be the real exception needed, not firefox. Use negative margin if Edge, otherwise 0 print page margin to hide default added header/footer on print.
Firefox printing centered, with a narrow word wrap area. Might have to reset page size setting or something. Or maybe i have to define my div larger.) 

Changed div margin to padding to fix black padding issue on print.

Added more CSS target divs to force dark mode to light mode for print.




3.0.4 ---

Hide the print headers and footers by default (with date and page info, like that chrome adds)
(Hide the header/footer added by the browser to print output.)
@media print {
@page {margin:0 -6cm}
html {margin:0 6cm}
}

Show the correct headers based on if POLD Only or Accessories Only are selected.
(Don't show "POLD System" if accessories top button is active.)

Hide last 2 lines of debugging into by default

Fix rare bug preventing more than 6 boxes of one item type (now >= 60).

Scroll to top on results page (if box list is long).

Add box count on each box title header, like Box 3 of 3 (or Box 3, if it's hard to find the total. could maybe use a variable at the end, or replace all instances of a specific string with box total, since box titles/numbers are being built/output to the string before we know the total number of boxes)

Change \n to <br /> & remove <pre> tag on results.
Possible ref i didn't use:
https://stackoverflow.com/questions/19438895/add-a-new-line-in-innerhtml

Add page breaks on results.
(Format print output to put each box in a 4x6 square or add page breaks if that's possible, to print on separate pages.)




3.0.3 ---

Added version number on bottom.

Back button from print screen in case they don't want to start over

POLD "pins" instead of "probes. -david

SSR in increments of 2. -david

When you click the POLD-Only header, only set cp to 0 if its more than 0. (so otherwise it will be blank)

Form validation for calculating the right number of polds when adding leak rope etc.

Made leak rope as an option to be attached to the pold by default, so they're packed together.

Modified a couple point values from bryce request:
Control Panel = 0  (changed from 1)
Hidden Wire = 3  (changed from 4.5)




3.0.2 ---

Changed reset button to an actual page refresh command, along with a scroll to top command.

(Reset button not fully working (doesn't activate LDS tab or hide the hidden wire length entry).
After resetting, you have to click checkboxes a couple times to get them working again.
Change the reset button to a submit button, to actually refresh the page?)

<!-- Maybe have a "leak rope? Y/N popup before the options show up. or a Probes/LeakRope selector, defaulting to probes.) -->

Hide extraPold section if POLDs goes back to 0.

Add a button to show debugging information (to show hidden divs with printed debugging text under each line printed from the packing function loop). 
Would require breaking the results text into separate strings and putting into separate divs though...
Maybe I could make a toggle before submitting, that runs or doesn't run the debugging lines (and keep them all in the same string).

Add split system stuff?
checkbox for b1 and b2, no real change. b3 needs a bit more logic.

Style the hidden wire length entry differently (card style?) and include ft as a designator/description.

Hidden wire should just be length entry (ft).
(maybe default it to 1 wire, or a checkbox which evaluates to 0 or 1).

Align checkbox right (keeping text and div section on left)
<input type="checkbox" class="form-check-input" id="checkHiddenWire">

Include hidden wire length in results text.




3.0.1 ---

Add the rest of the calculation logic.

if recirc or 4hr is the only overflow item, put in recirc box instead of accessory

QUESTION:  What do we do if we're sending multiple insulated pouches? multiple medium shippers, or a bigger box?
ANSWER:  Insulated Pouch will always only fit into the medium shipper. -Bryce
// Insulated Pouch
if (valueInsulPouch > 0) {

QUESTION:  If we have other accessories, should we fit an insulated pouch in an accessory box, or keep it in its own medium shipper?
ANSWER:  Insulated Pouch will always only fit into the medium shipper. -Bryce

Make the system toggles on top indicate something on the sheet (like make them a header on the report?).

// Four Hour Timer
// Does this always go in a 4hrtimer box or does it go in standard boxes like Shipper or 14x14?
--goes in shipper or accessory box with other stuff unless its the only other item

Auto generate & print packing label (packing list sticker on box, not fedex label or actual packing list). (Maybe create a new window at 4x6, or a text file on server side or something).

Highlight selected button (LDS) on load

Function/loop to replace if/else statements for loading group of items into box:
loadItemIntoBox(valueItem,spaceItem,totalValueItem,totalValueCurrent,boxValueLeft,boxValue,currentBox,nextBox,currentBoxValue,nextBoxValue)

Change alert box to something else.
(Javascript alert box truncated after 24 lines (or some amount of characters)).

Add a Reset/Continue/Clear/Start Over button to the results (as well as a Print button, defaulting to 4x6 and zebra printer)

declare all variables outside functions and
delete all extraneous "var" declarations. (dont redeclare/modify variables as  var variable = variable2;)
 (this worked, solved the issue)


// API v2
///////////////////////////////////////
// CURRENTLY WORKING ON   (variables are showing up as undefined, probably because they aren't global. actually because i kept redeclaring them as  var variable, so it created duplicates)
///////////////////////////////////////


When something won't fit in a box, it's currently putting it in the next box whether it fits or not.
Change it to:

function fitInBox {
var loopCount = 0;
while (loopCount < 6) {
 if (it fits) {
  put in box;
  subtract value from box;
  break;
 }
 else {
  change box
  loopCount++;
  if (loopCount == 6) {
  window.alert("I can't fit " + itemName + " in any box, after trying " + loopCount + " times.")
  break;
  }
 }
}


Change  totalValuePold   to 1 item at a time, until  totalValuePold  hits 0

Only include SCV if LDS is > 0

Add an extra variable, for boxValueLeft/boxSpaceLeft
Line 582

Subtract item value from each box. (is only subtracting from the total and comparing)

Fix checkbox not being able to be checked.

Highlight left/selected button by default (default to True)

Checkboxes should default to 0 or 1, not on or undefined.

Add Replacement text on top of dialog box.


QUESTIONS FOR BRYCE:

What's the default box for POLD-Only systems? Normal shipper? (define around line 612). 
// FUNCTION:  If LDS is 0 (POLD-Only)
---accessory box

(I guess accessories box is default extra box?)

// 14x14x14 = 48 (Use only if EJB is included or if Point total is greater than or equal to 49) -Bryce
// I'm guessing this is the overflow box and not the primary box -Jake
ya

// I'm assuming the four hour timer box is only used if a single timer or recirc switch is sent, but if both are sent, 
// then they'll be in something else?
if ((valueFourHour == 1 || valueRecirc == 1) && (totalValueTotal == 6)) {
ya put in accessory box


Add dark mode.

Add vertical spacing/padding/gutter/gap between div elements.

Change accordians to rows that start hidden until you click a button, so its one seamless block. (Just have many blocks already created, and only show the relevant ones as you press buttons.










(packing exceptions added in v3.0.11  2021-04-12)
// ignore this version
Change rules to prevent 2 14x14s when packing EJB with second mostly empty.
Only use a 14x14 if it’s packing 36 or more points of accessories, minus the junction box (and insulated pouch) values, (plus specifically pack EJB in a 14x14) then that may solve the issue of using a 14x14 for only a few accessories.
Move the logic from outside of the itempacking function into an if statement before it packs an item, so it leaves the default as an accessory box, then only changes the nextBox to a 14x14 before packing more than 36pt items minus the juncBox and pouch (and/or if it's packing a juncBox), then switch it back to accessory box.
Actually this will call for an accessory box for 2 items, then a 14x14 for a juncbox, when they could've fit in the same box.

// This should pack juncBox plus up to 12pt of accessories in a 14x14
after standard shipper is filled,
if (number of accessories minus ejb and pouch is less than 14x14 space (48) - ejb space (36) (i.e. if currentTotal - totalJuncBoxValue <= 12) nextBox = 14x14
// what happens if we have multiple juncBox though...
// we could have a negative result for the left side of the if statement.


// how about just seeing if we have 1 or more juncBox present first:
if (valueJuncBox >= 1) {
	// then subtracing the value of one juncBox from the currentTotal, and see if it's less than the space remaining in a 14x14 after packing a juncBox:
	if ((currentTotal - packingItem.juncBox) <= (packingItem.box14x14 - packingItem.juncBox) {
		nextBox = 14x14;
	}
}
else if ((currentTotal - packingItem.juncBox) <= (packingItem.box14x14 - packingItem.juncBox) {
	nextBox = 14x14;
}




//////////////// THIS

// Change rules to prevent 2 14x14s when packing EJB with second mostly empty.
// (actually we won't have a negative value because the juncBoxes are all added to the total, so using totalJuncBoxValue should work)

// This should pack juncBox plus up to 12pt of accessories in a 14x14.
// Run once standard shipper is filled,

// See if we have 1 or more juncBox present first:
if (valueJuncBox >= 1) {
	// then subtracing the value of the juncBoxes and insulPouches from the currentTotal (since we're only worried about the other accessories that will be packed in this box), 
	// and see if it's less than the space remaining in a 14x14 after packing a juncBox:
	// TODO:  Make sure the subtraction on the left is working as expected
	// This should allow packing up to 12pt of accessories in a 14x14 plus a juncBox
	if ((currentTotal - totalJuncBoxValue - totalInsulPouchValue) <= (packingItem.box14x14 - packingItem.juncBox) {
		nextBox = packingItem.box14x14;
	}
	// or if the total accessories (minus juncBox and insulPouch) are greater than or equal to 3 accessory boxes, then pack in a 14x14 instead
	// TODO:  Make sure the subtraction on the left is working as expected
	else if ((currentTotal - totalJuncBoxValue - totalInsulPouchValue) >= (packingItem.boxAccessories * 3) {
		nextBox = packingItem.box14x14;
	}
	else {
		nextBox = packingItem.boxAccessories;
		// or no change. return or do nothing, whatever
	}
}
// Duplicated from above, since it applies whether or not there's no juncBox
// TODO:  Make sure the subtraction on the left is working as expected
// or if the total accessories (minus juncBox and insulPouch) are greater than or equal to 3 accessory boxes, then pack in a 14x14 instead
else if ((currentTotal - totalJuncBoxValue - totalInsulPouchValue) >= (packingItem.boxAccessories * 3) {
	nextBox = packingItem.box14x14;
}
else {
	nextBox = packingItem.boxAccessories;
	// or no change. return or do nothing, whatever
}





// ignore this version
(Maybe make it work like the pouch.)
(Also only use 14x14x14 first if totalValueTotal >= 49 (or 36) minus the juncBox.)
(If accessories don't equal or exceed 36 points minus juncBox & insulPouch, Keep accessory box as primary nextBox, and just force the juncBox in a 14x14? )
(no that won't work because it's already doing that kinda and gonna waste space if you could fit 12 points of accessories in the 14x14 with it).)


